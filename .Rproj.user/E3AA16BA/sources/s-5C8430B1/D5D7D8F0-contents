---
title: "RoseArrayTools_vignette"
author: "Jeekin"
date: "4/5/2021"
output:   
  html_document:
    toc: true
    toc_float: true
---


# Introduction
This package will be a collection of tools that are routinely used by Texas A&M University Rose Breeding Program for analysis of genetic data from the WagRhSNP68k SNP array

# compare_probes
This function "compare_probes" takes as the input file the .dat long form file that fitPoly produces. However, on the WagRhSNP 68K SNP array, each marker is probed twice (forward and reverse strand). fitPoly scores all these probes as independent markers so we need to compare the probes. This function looks at each marker by looking at the genotype calls at each of the two probes for that given marker. The result of this function prints two new files, a compared_calls.csv file and a compared_calls_kind_counts.csv. 

This function takes a very long time. If you set progress=T or by default it is T, it will tell you which step it is on. Steps 1-3 are just background steps to start the comparison. They go relatively quickly. The steps comparing_probes and Marker_stats take a while longer and when the function is done it will print "FINISHED" in the console.

```{r eval=FALSE, include=T}
compare_probes(data_dat="path_to_file.dat", progress=T)
```

# dosage_to_ACGT
This function "dosage_to_ACGT" requires a csv file returned from fitPoly formatted like below (left) and converts it to what you see on the right. The A allele is the "reference" allele and the B allele is the alternative allele and dosage is defined as the number of copies of the alternative allele.

This is how to use the function. Be aware, this function was written as a loop inside of a loop with 5 ifelse statements thus on large files with many individuals it will take a long time. However there the console will print the marker number it is currently on to give you an estimate to the amount of time left. Default for progress is TRUE however if progress is set at F it will not print the markers completed and will only print a message of "FINISHED" when done.

```{r eval=FALSE, include=T}
dosage_to_ACGT(dosage.file="path_to_dosage_file.csv", progress=T)
```


![image of input file and output file formats](C:/Users/Jeekin/Dropbox/Projects/R_Packages/Dosage_to_ACGT/DoseToACGT/Screenshot 2021-04-02 151131.png)

